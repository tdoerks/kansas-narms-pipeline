params {
    input = 'samplesheet.csv'
    outdir = 'results'
    
    // Resource limits
    max_memory = '100.GB'
    max_cpus = 16
    max_time = '24.h'
}

// Apptainer configuration (like your working pipeline)
apptainer {
    enabled = true
    autoMounts = true
    cacheDir = "$HOME/.apptainer/cache"
}

// Slurm executor configuration
executor {
    name = 'slurm'
    queueSize = 50
}

process {
    executor = 'slurm'
    
    // Default resources with killable option
    memory = '8.GB'
    cpus = 4
    time = '2.h'
    clusterOptions = '--gres=killable:0'
    
    withName: 'AMRFINDER_UPDATE' {
        container = 'quay.io/biocontainers/ncbi-amrfinderplus:3.12.8--h283d18e_0'
        memory = '4.GB'
        cpus = 2
        time = '30m'
        clusterOptions = ''  // Remove killable for database download
    }
    
    withName: 'AMRFINDER_RUN' {
        container = 'quay.io/biocontainers/ncbi-amrfinderplus:3.12.8--h283d18e_0'
        memory = '8.GB'
        cpus = 4
        time = '1h'
    }
}

// Error handling
process.shell = ['/bin/bash', '-euo', 'pipefail']
